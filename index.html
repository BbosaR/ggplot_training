<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>DATA VISUALIZATION TRAINING with R</title>
    <meta charset="utf-8" />
    <meta name="author" content="UI-LISA Collaborators" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/chocolate.css" rel="stylesheet" />
    <link href="libs/remark-css/rladies-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">






class: inverse, center

&lt;div style="text-align: left"&gt;
&lt;img style="float: center; margin: 0px 15px 15px 0px;" src="picture/UI.png" width="80" height="100"/&gt;
&lt;/div&gt;


## Data Visualization Training (ggplot2)

#### UI LISA&lt;br&gt; Materials: https://fomotis.github.io/ggplot_training/

&lt;div style="text-align: right"&gt;
&lt;img style="float: center; margin: 0px 15px 15px 0px;" src="picture/UI_LISA.jpg" width="80" height="100"/&gt;
&lt;/div&gt;


---
class: center, middle

# Week one

`Assumptions` &lt;br&gt;

`Grammar of graphics` &lt;br&gt;

`Enters ggplot2` &lt;br&gt;

`Why the fuss about ggplot2?` &lt;br&gt;

---

# Assumptions

1. You have access to internet ‚úîÔ∏è

2. You have some experience working with `R` ‚ùì

3. You like cool graphics üòÑ

## Desirable but not necessary

1. You have some experience with `tidyverse` and `piping(%&gt;%)` üëç


#### ‚ùå assumption 2  ‚û°Ô∏è crash course in `R` and `tidyverse`

#### ‚úîÔ∏è assumption 2  ‚û°Ô∏è Grammar of graphics

---

# Crash course in `R` and `tidyverse`

---

# Grammar of graphics

.pull-left[
&lt;img src="picture/Hadley-wickham.jpg" width="200" height="300"&gt;
]

.pull-right[

* Term coined by `Leland Wilkinson` expanded to layered grammar of graphics by `Hadley Wickham`.

* *"A grammar of graphics is a tool that enables us to concisely describe the components of a graphic. Such a grammar allows us to move beyond named graphics and gain insight into the deep structure that underlies statistical graphics"*.

* The concept is essentially a set of rules that allows us to think of a statistical graphic beyond a certain name and format. 
]

---

# Grammar of graphics 2

* With this tool, you don't have to think about a scatter or box plot, but what set of information should I put on this graph to convey the message I want. 

* A plot is any name you give it. While the elements of the plots are merely verbs.

* To 


```r
data("HairEyeColor")
```

.footnote[http://dx.doi.org/10.1198/jcgs.2009.07098]

---

# Enters GGplot2

* base `R` plots can be built based 

---
class: center, middle

# Week two

`Basic ggplot2 functions (ggplot and qplot)` &lt;br&gt;

`Basic plots with ggplot2` &lt;br&gt;

---

# Basic ggplot2 functions

---

# Aesthetics

---

# Basic plots with ggplot2

---
class: center, middle

# Week three

`Legends and Themes customization` &lt;br&gt;

---

# Themes

---

# Available Themes

---

# Customising Themes


---
class: center, middle

# Week four

---

# Week four topic one

---

# Week four topic two

---

# Week four topic three

---
class: center, middle

# Week five

---

# Week five topic one

---

# Week five topic two

---

# Week five topic three



---
class: center, middle

# Week six

---

# Week six topic one

---

# Week six topic two

---

# Week six topic three


---
# Week seven topic one

---
# week seven topic two

---
# week seven topic three

---
class: center, middle

# Week Eight
---


## Proponent(s) of Facets
.pull-left[

* **Facets** were popularised by Edward Tuffe in his 1983 book, *The Visual Display of Quantivative Information*, from a concept of small multiples.

![](picture/book_cover.png)
]

.pull-right[
* The idea is that we can spread up a small part to produce multiple 
smaller parts that have the same cordinate system.

Taking an example of tips per total bill

![](picture/tips.png)
]

---
## **Purpose of Facets**

Faceting helps to split the data up into groups, according to a categorical variable, then plots each group in its own panel.

![](picture/tips2.png)

---
## Install the required packages and load the libraries

install.packages("ggplot2")

install.packages("tidyverse")

library(ggplot2)

library(reshape2)

* Inspect the variables in `tips` data set from `reshape` library

```r
names(tips)
head(tips)
str(tips)
```

---
## Formula notation

Faceting splits the data up into groups, according to a categorical variable, 
then plots each group in its own panel. 

For splitting the data by one or two categorical variables, `facet_grid()` is 
used. As well as the `vars()` notation for specifying which variables should
be used to split the dataset into facets.

* To divide by "sex" vertically;-


```r
ggplot(tips, aes(x=total_bill, 
                 y=tip/total_bill)) + 
  geom_point(shape=1) + 
  facet_grid(cols = vars(sex)) # or facet_grid(. ~ sex)
```

* To divide by "sex' horizontally;-


```r
library(ggplot2)
library(reshape2)
ggplot(tips, aes(x=total_bill, 
                 y=tip/total_bill)) + 
  geom_point(shape=1) + 
  facet_grid(rows = vars(sex)) # or facet_grid(sex ~ .)
```


---
## **Results**
.pull-left[
* To divide by "sex" vertically;-
&lt;img src="picture/tips3.png" style="width:400px;height:300px; center;"&gt;

]

.pull-right[
* To divide by "sex" vertically;-
![](picture/tips4.png)
]

---
## **How to Add two categories**
In order to add two categories, both the `rows` and `cols` arguments in `facet_grid` are used.

![](picture/tips5.png)

---
## **Using geom_bar chart**

Using WDI data from the World Bank, population demographics can be categorised as Urban and Rural. Data was obtained from 2015 to 2018 for the Southern Africa countries namely Eswatini, Angola, Botswana, Malawi, South Africa, Mozambique, Zambia , Zimbabwe, Namibia,Lesotho, South Africa, Botswana and Angola.

Using the 'Rural_Urban_lg.csv' file, first inspect the variables in the dataset



```r
Rural_Urban_lg &lt;- read.csv("~/UI_LISA/Training_2/ggplot_training/Data/Rural_Urban_lg.csv", 
                          header = TRUE, stringsAsFactors = FALSE)
names(Rural_Urban_lg) # To know the list of all variables 
str(Rural_Urban_lg) # To know the structure of the given variables
head(Rural_Urban_lg) # To know the first 6 rows (observations)
tail(Rural_Urban_lg) # To know the last 6 rows (observations)
```


---
## **Plotting the bar chart**

```r
ggplot(Rural_Urban_lg, aes(country, Total_Pop, fill= country)) +
  geom_bar(aes(reorder(country, Total_Pop),Total_Pop),
           stat= "identity", show.legend = TRUE) +
  scale_fill_brewer(palette = "Paired")+
  facet_grid(Pop_Setting ~ year ,labeller= label_context, 
              scales = "free") +
  geom_text(aes(label= Total_Pop), hjust=-0.1, colour="black",
             size=2.2, angle=90) +
  ylab("Proportion of population (%)") +
  theme(axis.text.x = element_text(angle = 90, hjust =1, vjust=0.2))
```


---
## **Results**
&lt;img src="picture/wb1.png" style="width:700px;height:500px; center;"&gt;

---
## **Comparing geom_bar with Miscrosoft Excel output**
&lt;img src="picture/Urban_Rural_Proportion.jpg" style="width:800px;height:500px; center;"&gt;

---

## **Using facet_wrap**


```r
ggplot(Rural_Urban_lg, aes(country, Total_Pop, fill= country)) +
  geom_bar(aes(reorder(country, Total_Pop),Total_Pop),
           stat= "identity", show.legend = TRUE) +
   geom_text(aes(label= Total_Pop), hjust=-0.2, colour="black",
             size=3, angle=90) +
    scale_fill_brewer(palette = "Paired")+
  ylab("Proportion of population (%)") +
   facet_wrap(Pop_Setting ~ year, nrow = 2, scales = "free") +
   theme(axis.text.x = element_text(angle = 90, hjust =1, vjust=0.2))
```


---
## **Results**
&lt;img src="picture/wb2.png" style="width:800px;height:500px; center;"&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="cols_macro.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
